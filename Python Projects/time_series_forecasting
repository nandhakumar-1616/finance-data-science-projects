import pandas as pd
import matplotlib.pyplot as pltimport 
import numpy as np
from sklearn.preprocessing import MinMaxScaler
from sklearn.metrics import mean_squared_error, mean_absolute_error
import warnings
warnings.filterwarnings('ignore')


class TimeSeriesForecaster:
    def __init__(self, data, test_size=0.2):
        self.data = pd.Series(data) if not isinstance(data, pd.Series) else data
        self.test_size = test_size
        self.scaler = MinMaxScaler()
        self.train_size = int(len(self.data) * (1 - test_size))
        self.train_data = self.data[:self.train_size]
        self.test_data = self.data[self.train_size:]
    
    def moving_average_forecast(self, window=5, periods=10):
        last_values = self.data[-window:].values
        forecast = []
        for _ in range(periods):
            forecast.append(np.mean(last_values))
            last_values = np.append(last_values[1:], forecast[-1])
        return np.array(forecast)
    
    def exponential_smoothing(self, alpha=0.3, periods=10):
        forecast = []
        level = self.data.iloc[0]
        
        for value in self.data[1:]:
            level = alpha * value + (1 - alpha) * level
        
        for _ in range(periods):
            forecast.append(level)
        return np.array(forecast)
    
    def evaluate_model(self, predictions, actual):
        mse = mean_squared_error(actual, predictions[:len(actual)])
        rmse = np.sqrt(mse)
        mae = mean_absolute_error(actual, predictions[:len(actual)])
        return {'MSE': mse, 'RMSE': rmse, 'MAE': mae}


def main():
    print("Time Series Forecasting Module Initialized")


if __name__ == "__main__":
    main()